# #0 绪论

- 通信的定义：通信是发送者通过某种媒体以某种格式来传递信息到收信者以达致某个目的。
- 通信的实质：在一点精确或近似的再生另一点的信息。

不要觉以为只有把某个实物真正传递过去才叫通信，这是面向过程的思维。再生是面向结果的思维，面向结果的思维对计算机其他学科也大有脾益，比如理解量子纠缠和力扣上的某些题（杀死结点）。

## 1 互联网的组成

- 互联网的**边缘部分**：由所有连接在互联网上的主机组成。供用户进行通信和资源共享。

  计算机之间通信：主机 A 的某个进程和主机 B 上的另一个进程进行通信。

  网络边缘的端系统之间的通信方式可分为两类：客户-服务器方式（C/S）和对等方式（P2P）。

  

- 互联网的**核心部分**：由大量网络和连接这些网络的路由器组成。核心部分为边缘部分提供连通性和交换。

  在网络核心部分起特殊作用的是路由器，它是一种专用计算机（但不是主机）。路由器是实现分组交换的关键构件，其任务是转发收到的分组，这是网络核心部分最重要的功能。

  

  **电路交换**（英语：Circuit Switching）是相对于报文交换的一个概念。电路交换要求必须先在通信双方之间建立连接。在通话的全部时间内，通话的两个用户始终占用端到端的通信资源。因为计算机数据是突发式地出现在传输线路上的，所以这种“始终占用”的通信方式其线路的传输效率很低。

  - 数据传送特点：整个报文的比特流**连续**地从源点**直达**终点。

  

  **分组交换**（英语：Packet switching）是一种相对于电路交换的通信范例。不需要在传输前先建立通信路径。分组交换采用**存储转发**技术。通常把待发送的整块数据称为报文，发送数据前先将报文划分成较小的等长数据段，每个数据段前面加上一些由必要控制信息组成的首部，首部和数据构成一个分组。分组的首部包含了诸如目的地址和源地址等重要控制信息，因此每一个分组才能在互联网中独立地选择传输路径，并被正确地交付到分组传输的终点。位于网络边缘的主机和位于网络核心地路由器都是计算机，但作用不同：主机是为用户进行信息处理的，并可以和其他主机通过网络交换信息。路由器是用来转发分组的，即进行分组交换的。路由器收到一个分组，先暂时**存储**一下，检查其首部，查找转发表，按照首部中的目的地址找到合适的借口**转发**出去，把分组交给了另一个路由器，这样一步一步地以存储转发的方式把分组交付给最终的目的主机。这一过程有时会经过几十个不同的路由器。

  - 数据传送特点：报文的**一部分**，即单个分组，传送到相邻结点，**存储**下来后查找转发表，**转发**到下一个结点。

  

  **报文交换**（英语： Message switching），又称存储转发交换，是数据交换的三种方式之一。报文整个地发送，一次一跳。报文交换是分组交换的前身。

  - 数据传送特点：**整个**报文先传送到相邻结点，在下一次交换前被存储，**存储**下来后查找转发表，**转发**到下一个结点。

  

  对比：

   1. 若要连续传送大量数据，且传送时间远大于连接建立时间，则电路交换速率最快。
   2. 报文交换和分组交换不需要预先分配传输带宽，因此传送突发数据时可提高整个网络的信道利用率。
   3. 一个分组长度远小于整个报文长度，因此分组交换的时延小于报文交换，且灵活性更强。

  

## 2 计算机网络的性能

- 速率

- 带宽

- 吞吐量

- 时延 总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延
  1. 发送时延 货车出站 主机或路由器发送数据帧所需要的时间
  2. 传播时延 高架行驶 电磁波在信道中传播一定的距离所需要的时间
  3. 处理时延 货车进站 主机或路由器收到分组时分析分组首部、提取数据部分、进行差错分析、查找适当路由等操作所需要的时间
  4. 排队时延 收费站排队 分组在经过网络传输时要经过许多路由器，分组进入路由器后先在输入队列中排队等待处理，待路由器确定转发接口后还需要再输出队列中排队等待转发，这就产生了排队时延。
  
- 时延带宽积

- 往返时间 RTT

- 利用率

  利用率有信道利用率和网络利用率两种。

  时延与利用率的关系：我们必须有这样的概念——信道或网络的利用率过高会产生非常大的时延。

## 3 计算机网络体系结构

网络协议三要素：语法 语义 同步

- 理论上：OSI 七层协议体系机构
- 实际上：TCP/IP 四层体系结构
- 学习中：五层协议体系结构

|            | PDU 协议数据单元       | 设备                               | 关键词                               |
| ---------- | ---------------------- | ---------------------------------- | ------------------------------------ |
| 应用层     | message 数据、报文     |                                    | DNS FTP SMTP IMAP POP3 WWW HTTP DHCP |
| 传输层     | segment 数据段、报文段 | 四层交换机                         | TCP UDP                              |
| 网络层     | packet 数据包          | 路由器 三层交换机                  | IP                                   |
| 数据链路层 | frame 帧               | 网桥 网卡 交换机                   | MAC LLC PPP                          |
| 物理层     | bit 比特               | 中继器 集线器 双绞线 同轴电缆 光纤 |                                      |

1. 应用层（application layer）

   应用层的任务是**通过应用进程间的交互来完成特定网络应用**。应用层协议定义的是应用进程间通信和交互的规则。

2. 传输层（transport layer）

   传输层的任务是负责**向两台主机中进程之间的通信提供通用的数据传输服务**。应用进程利用该服务传送应用层报文。

   主要使用两种协议：

   - 传输控制协议 TCP——提供面向连接的、可靠的数据传输服务。其数据传输单位是报文段。
   - 用户数据报协议 UDP——提供无连接的、尽最大努力的数据传输服务（不保证数据传输的可靠性）。其数据传输单位是用户数据报。

3. 网络层（network layer）

   网络层负责为分组交换网上的不同主机提供通信服务。在发送数据时，网络层把运输层产生的报文段或用户数据报封装成分组或包进行传送。在 TCP/IP 体系结构中，由于网络层使用 IP 协议，因此分组也叫做 IP 数据报，或简称为数据报。本书将“分组”和“数据报”视为同义词使用。
   
   网络层的另一个任务是选择合适的路由，使源主机运输层所传下来的分组能够通过网络中的路由器找到目的主机。
   
   网络层的网络二字已经不是我们通常谈到的具体网络，而是计算机网络提及结构模型中的第 3 层名称。互联网是由大量异构网络通过路由器相互连接起来的。网络层也叫 IP 层。
   
4. 数据链路层（data link layer）

   在发送数据时，数据链路层负责将网络层交下来的 IP 数据报**组装成帧**，在两个相邻结点间的链路上传送帧。每一帧包括数据和必要的控制信息（同步信息、地址信息、差错控制）。控制信息使接收端能够知道一个帧从哪个比特开始到哪个比特结束。在接收数据时，数据链路层收到一个帧后提取出数据部分，将其上交给网络层。控制信息还能使接收端能够检测收到的帧中有无差错。如有差错则将此帧丢弃以免继续传递浪费网络资源。如需要数据链路层不仅要检错还要纠错，则要采用可靠传输协议来纠正差错，但会使链路层的协议变得更复杂。

5. 物理层（physical layer）

   物理层需要考虑用多大的电压代表 1 或 0，以及接收方如何识别出发送方所发送的比特。物理层还要确定连接电缆的插头应有多少根引脚以及各引脚应如何连接。